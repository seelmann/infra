ServerName localhost

<VirtualHost _default_:443>
  #ServerAlias www.foo.com
  DocumentRoot /var/www/html

  #LogLevel info ssl:warn
  LogLevel warn ldap:debug authnz_ldap:debug
  ErrorLog ${APACHE_LOG_DIR}/error.log
  CustomLog ${APACHE_LOG_DIR}/access.log combined

  SSLEngine on
  SSLCertificateFile /etc/ssl/certs/{{inventory_hostname}}.crt
  SSLCertificateKeyFile /etc/ssl/private/{{inventory_hostname}}.key
  SSLProtocol all -SSLv2 -SSLv3
  SSlCipherSuite ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA256:ECDHE-RSA-AES256-SHA:ECDHE-RSA-AES128-SHA:DHE-RSA-AES256-SHA:DHE-RSA-AES128-SHA;
  SSLHonorCipherOrder on

  <Location />
    SSLRequireSSL

    AuthType Basic
    AuthName "LDAP"
    AuthBasicProvider ldap
    AuthLDAPURL "ldap://{{ldap.host}}:389/{{ldap.baseDN}}?uid?sub?(objectClass=inetOrgPerson)" STARTTLS
    require valid-user
  </Location>

</VirtualHost>

